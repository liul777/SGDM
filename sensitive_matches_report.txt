---
Path: D:\pythonproject\YHJ\multi-classification\Deployment.ipynb
Line: 125
Match: token
ContextBefore:
      "Requirement already satisfied: wcwidth in d:\\anaconda\\envs\\yolov10\\lib\\site-packages (from prompt-toolkit!=3.0.37,<3.1.0,>=3.0.30->ipython->ai-edge-model-explorer) (0.2.13)\n",
      "Requirement already satisfied: executing>=1.2.0 in d:\\anaconda\\envs\\yolov10\\lib\\site-packages (from stack-data->ipython->ai-edge-model-explorer) (2.2.1)\n",
MatchedLine:
      "Requirement already satisfied: asttokens>=2.1.0 in d:\\anaconda\\envs\\yolov10\\lib\\site-packages (from stack-data->ipython->ai-edge-model-explorer) (3.0.0)\n",
ContextAfter:
      "Requirement already satisfied: pure_eval in d:\\anaconda\\envs\\yolov10\\lib\\site-packages (from stack-data->ipython->ai-edge-model-explorer) (0.2.3)\n"
     ]
---
Path: D:\pythonproject\YHJ\multi-classification\Deployment.ipynb
Line: 151
Match: token
ContextBefore:
      "argon2-cffi               21.3.0\n",
      "argon2-cffi-bindings      21.2.0\n",
MatchedLine:
      "asttokens                 3.0.0\n",
ContextAfter:
      "async-lru                 2.0.4\n",
      "attrs                     24.3.0\n",
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\index.md
Line: 28
Match: token
ContextBefore:
  <br>
  <a href="https://github.com/ultralytics/ultralytics/actions/workflows/ci.yaml"><img src="https://github.com/ultralytics/ultralytics/actions/workflows/ci.yaml/badge.svg" alt="Ultralytics CI"></a>
MatchedLine:
  <a href="https://codecov.io/github/ultralytics/ultralytics"><img src="https://codecov.io/github/ultralytics/ultralytics/branch/main/graph/badge.svg?token=HHW7IIVFVY" alt="Ultralytics Code Coverage"></a>
ContextAfter:
  <a href="https://zenodo.org/badge/latestdoi/264818686"><img src="https://zenodo.org/badge/264818686.svg" alt="YOLOv8 Citation"></a>
  <a href="https://hub.docker.com/r/ultralytics/ultralytics"><img src="https://img.shields.io/docker/pulls/ultralytics/ultralytics?logo=docker" alt="Docker Pulls"></a>
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\quickstart.md
Line: 317
Match: api_key
ContextBefore:
| `uuid`             | `'a1b2c3d4'`          | `str`     | The unique identifier for the current settings                                                                   |
| `sync`             | `True`                | `bool`    | Whether to sync analytics and crashes to HUB                                                                     |
MatchedLine:
| `api_key`          | `''`                  | `str`     | Ultralytics HUB [API Key](https://hub.ultralytics.com/settings?tab=api+keys)                                     |
ContextAfter:
| `clearml`          | `True`                | `bool`    | Whether to use ClearML logging                                                                                   |
| `comet`            | `True`                | `bool`    | Whether to use [Comet ML](https://bit.ly/yolov8-readme-comet) for experiment tracking and visualization          |
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\datasets\explorer\dashboard.md
Line: 35
Match: api_key
ContextBefore:

    Ask AI feature works using OpenAI, so you'll be prompted to set the api key for OpenAI when you first run the GUI.
MatchedLine:
    You can set it like this - `yolo settings openai_api_key="..."`
ContextAfter:

## Semantic Search / Vector Similarity Search
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\datasets\explorer\index.md
Line: 56
Match: api_key
ContextBefore:

    Ask AI feature works using OpenAI, so you'll be prompted to set the api key for OpenAI when you first run the GUI.
MatchedLine:
    You can set it like this - `yolo settings openai_api_key="..."`
ContextAfter:

<p>
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\guides\security-alarm-system.md
Line: 48
Match: Password
ContextBefore:
???+ tip "Note"

MatchedLine:
    App Password Generation is necessary
ContextAfter:

- Navigate to [App Password Generator](https://myaccount.google.com/apppasswords), designate an app name such as "security project," and obtain a 16-digit password. Copy this password and paste it into the designated password field as instructed.
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\guides\security-alarm-system.md
Line: 50
Match: Password
ContextBefore:
    App Password Generation is necessary

MatchedLine:
- Navigate to [App Password Generator](https://myaccount.google.com/apppasswords), designate an app name such as "security project," and obtain a 16-digit password. Copy this password and paste it into the designated password field as instructed.
ContextAfter:

```python
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\guides\security-alarm-system.md
Line: 53
Match: password
ContextBefore:

```python
MatchedLine:
password = ""
ContextAfter:
from_email = ""  # must match the email used to generate the password
to_email = ""  # receiver email
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\guides\security-alarm-system.md
Line: 54
Match: password
ContextBefore:
```python
password = ""
MatchedLine:
from_email = ""  # must match the email used to generate the password
ContextAfter:
to_email = ""  # receiver email
```
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\guides\security-alarm-system.md
Line: 63
Match: password
ContextBefore:
server = smtplib.SMTP('smtp.gmail.com: 587')
server.starttls()
MatchedLine:
server.login(from_email, password)
ContextAfter:
```

---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\help\CI.md
Line: 55
Match: token
ContextBefore:
| Repository                                                | Code Coverage                                                                                                                                           |
|-----------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|
MatchedLine:
| [ultralytics](https://github.com/ultralytics/ultralytics) | [![codecov](https://codecov.io/gh/ultralytics/ultralytics/branch/main/graph/badge.svg?token=HHW7IIVFVY)](https://codecov.io/gh/ultralytics/ultralytics) |
ContextAfter:

In the sunburst graphic below, the innermost circle is the entire project, moving away from the center are folders then, finally, a single file. The size and color of each slice is representing the number of statements and the coverage, respectively.
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\help\CI.md
Line: 60
Match: token
ContextBefore:

<a href="https://codecov.io/github/ultralytics/ultralytics">
MatchedLine:
    <img src="https://codecov.io/gh/ultralytics/ultralytics/branch/main/graphs/sunburst.svg?token=HHW7IIVFVY" alt="Ultralytics Codecov Image">
ContextAfter:
</a>
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\help\security.md
Line: 26
Match: Secret
ContextBefore:
[Dependabot](https://docs.github.com/en/code-security/dependabot) is integrated into our workflow to monitor dependencies for known vulnerabilities. When a vulnerability is identified in one of our dependencies, Dependabot alerts us, allowing for swift and informed remediation actions.

MatchedLine:
## GitHub Secret Scanning Alerts
ContextAfter:

We employ GitHub [secret scanning](https://docs.github.com/en/code-security/secret-scanning/managing-alerts-from-secret-scanning) alerts to detect sensitive data, such as credentials and private keys, accidentally pushed to our repositories. This early detection mechanism helps prevent potential security breaches and data exposures.
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\help\security.md
Line: 28
Match: secret
ContextBefore:
## GitHub Secret Scanning Alerts

MatchedLine:
We employ GitHub [secret scanning](https://docs.github.com/en/code-security/secret-scanning/managing-alerts-from-secret-scanning) alerts to detect sensitive data, such as credentials and private keys, accidentally pushed to our repositories. This early detection mechanism helps prevent potential security breaches and data exposures.
ContextAfter:

## Private Vulnerability Reporting
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\hub\inference-api.md
Line: 42
Match: API_KEY
ContextBefore:
url = f"https://api.ultralytics.com/v1/predict/MODEL_ID"

MatchedLine:
# Headers, use actual API_KEY
ContextAfter:
headers = {"x-api-key": "API_KEY"}

---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\hub\inference-api.md
Line: 43
Match: api-key
ContextBefore:

# Headers, use actual API_KEY
MatchedLine:
headers = {"x-api-key": "API_KEY"}
ContextAfter:

# Inference arguments (optional)
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\hub\inference-api.md
Line: 56
Match: API_KEY
ContextBefore:
```

MatchedLine:
In this example, replace `API_KEY` with your actual API key, `MODEL_ID` with the desired model ID, and `path/to/image.jpg` with the path to the image you want to analyze.
ContextAfter:

## Example Usage with cURL
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\hub\inference-api.md
Line: 60
Match: API_KEY
ContextBefore:
## Example Usage with cURL

MatchedLine:
You can use the YOLO Inference API with client URL (cURL) by utilizing the `curl` command. Replace `API_KEY` with your actual API key, `MODEL_ID` with the desired model ID, and `image.jpg` with the path to the image you want to analyze:
ContextAfter:

```bash
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\hub\inference-api.md
Line: 64
Match: api-key
ContextBefore:
```bash
curl -X POST "https://api.ultralytics.com/v1/predict/MODEL_ID" \
MatchedLine:
	-H "x-api-key: API_KEY" \
ContextAfter:
	-F "image=@/path/to/image.jpg" \
	-F "size=640" \
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\hub\inference-api.md
Line: 73
Match: API_KEY
ContextBefore:
## Passing Arguments

MatchedLine:
This command sends a POST request to the YOLO Inference API with the specified `MODEL_ID` in the URL and the `API_KEY` in the request `headers`, along with the image file specified by `@path/to/image.jpg`.
ContextAfter:

Here's an example of passing the `size`, `confidence`, and `iou` arguments via the API URL using the `requests` library in Python:
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\hub\inference-api.md
Line: 83
Match: API_KEY
ContextBefore:
url = f"https://api.ultralytics.com/v1/predict/MODEL_ID"

MatchedLine:
# Headers, use actual API_KEY
ContextAfter:
headers = {"x-api-key": "API_KEY"}

---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\hub\inference-api.md
Line: 84
Match: api-key
ContextBefore:

# Headers, use actual API_KEY
MatchedLine:
headers = {"x-api-key": "API_KEY"}
ContextAfter:

# Inference arguments (optional)
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\hub\inference-api.md
Line: 140
Match: api-key
ContextBefore:
        ```bash
        curl -X POST "https://api.ultralytics.com/v1/predict/MODEL_ID" \
MatchedLine:
            -H "x-api-key: API_KEY" \
ContextAfter:
            -F "image=@/path/to/image.jpg" \
            -F "size=640" \
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\hub\inference-api.md
Line: 155
Match: API_KEY
ContextBefore:
        url = f"https://api.ultralytics.com/v1/predict/MODEL_ID"

MatchedLine:
        # Headers, use actual API_KEY
ContextAfter:
        headers = {"x-api-key": "API_KEY"}

---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\hub\inference-api.md
Line: 156
Match: api-key
ContextBefore:

        # Headers, use actual API_KEY
MatchedLine:
        headers = {"x-api-key": "API_KEY"}
ContextAfter:

        # Inference arguments (optional)
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\hub\inference-api.md
Line: 238
Match: api-key
ContextBefore:
        ```bash
        curl -X POST "https://api.ultralytics.com/v1/predict/MODEL_ID" \
MatchedLine:
            -H "x-api-key: API_KEY" \
ContextAfter:
            -F "image=@/path/to/image.jpg" \
            -F "size=640" \
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\hub\inference-api.md
Line: 253
Match: API_KEY
ContextBefore:
        url = f"https://api.ultralytics.com/v1/predict/MODEL_ID"

MatchedLine:
        # Headers, use actual API_KEY
ContextAfter:
        headers = {"x-api-key": "API_KEY"}

---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\hub\inference-api.md
Line: 254
Match: api-key
ContextBefore:

        # Headers, use actual API_KEY
MatchedLine:
        headers = {"x-api-key": "API_KEY"}
ContextAfter:

        # Inference arguments (optional)
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\hub\inference-api.md
Line: 379
Match: api-key
ContextBefore:
        ```bash
        curl -X POST "https://api.ultralytics.com/v1/predict/MODEL_ID" \
MatchedLine:
            -H "x-api-key: API_KEY" \
ContextAfter:
            -F "image=@/path/to/image.jpg" \
            -F "size=640" \
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\hub\inference-api.md
Line: 394
Match: API_KEY
ContextBefore:
        url = f"https://api.ultralytics.com/v1/predict/MODEL_ID"

MatchedLine:
        # Headers, use actual API_KEY
ContextAfter:
        headers = {"x-api-key": "API_KEY"}

---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\hub\inference-api.md
Line: 395
Match: api-key
ContextBefore:

        # Headers, use actual API_KEY
MatchedLine:
        headers = {"x-api-key": "API_KEY"}
ContextAfter:

        # Inference arguments (optional)
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\integrations\comet.md
Line: 48
Match: API_KEY
ContextBefore:
        ```bash
        # Set your Comet Api Key
MatchedLine:
        export COMET_API_KEY=<Your API Key>
ContextAfter:
        ```

---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\integrations\roboflow.md
Line: 181
Match: api-key
ContextBefore:
```

MatchedLine:
In this code, replace the project ID and version ID with the values for your account and project. [Learn how to retrieve your Roboflow API key](https://docs.roboflow.com/api-reference/authentication#retrieve-an-api-key).
ContextAfter:

When you run the code above, you will be asked to authenticate. Then, your model will be uploaded and an API will be created for your project. This process can take up to 30 minutes to complete.
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\yolov5\tutorials\comet_logging_integration.md
Line: 36
Match: API_KEY
ContextBefore:

```shell
MatchedLine:
export COMET_API_KEY=<Your Comet API Key>
ContextAfter:
export COMET_PROJECT_NAME=<Your Comet Project Name> # This will default to 'yolov5'
```
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\yolov5\tutorials\comet_logging_integration.md
Line: 46
Match: api_key
ContextBefore:
```
[comet]
MatchedLine:
api_key=<Your Comet API Key>
ContextAfter:
project_name=<Your Comet Project Name> # This will default to 'yolov5'
```
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\yolov5\tutorials\roboflow_datasets_integration.md
Line: 42
Match: api_key
ContextBefore:
```
from roboflow import Roboflow
MatchedLine:
rf = Roboflow(api_key="YOUR API KEY HERE")
ContextAfter:
project = rf.workspace().project("YOUR PROJECT")
dataset = project.version("YOUR VERSION").download("yolov5")
---
Path: D:\pythonproject\YHJ\multi-classification\docs\en\yolov5\tutorials\train_custom_data.md
Line: 160
Match: API_KEY
ContextBefore:
```shell
pip install comet_ml  # 1. install
MatchedLine:
export COMET_API_KEY=<Your API Key>  # 2. paste API key
ContextAfter:
python train.py --img 640 --epochs 3 --data coco128.yaml --weights yolov5s.pt  # 3. train
```
---
Path: D:\pythonproject\YHJ\multi-classification\examples\hub.ipynb
Line: 97
Match: API_KEY
ContextBefore:
      },
      "source": [
MatchedLine:
        "hub.login('API_KEY')  # use your API key\n",
ContextAfter:
        "\n",
        "model = YOLO('https://hub.ultralytics.com/MODEL_ID')  # use your model URL\n",
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\cfg\__init__.py
Line: 365
Match: api_key
ContextBefore:
    Example:
        ```bash
MatchedLine:
        python my_script.py hub login your_api_key
ContextAfter:
        ```
    """
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\data\explorer\utils.py
Line: 117
Match: api_key
ContextBefore:
    from openai import OpenAI

MatchedLine:
    if not SETTINGS["openai_api_key"]:
ContextAfter:
        logger.warning("OpenAI API key not found in settings. Please enter your API key below.")
        openai_api_key = getpass.getpass("OpenAI API key: ")
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\data\explorer\utils.py
Line: 119
Match: api_key
ContextBefore:
    if not SETTINGS["openai_api_key"]:
        logger.warning("OpenAI API key not found in settings. Please enter your API key below.")
MatchedLine:
        openai_api_key = getpass.getpass("OpenAI API key: ")
ContextAfter:
        SETTINGS.update({"openai_api_key": openai_api_key})
    openai = OpenAI(api_key=SETTINGS["openai_api_key"])
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\data\explorer\utils.py
Line: 120
Match: api_key
ContextBefore:
        logger.warning("OpenAI API key not found in settings. Please enter your API key below.")
        openai_api_key = getpass.getpass("OpenAI API key: ")
MatchedLine:
        SETTINGS.update({"openai_api_key": openai_api_key})
ContextAfter:
    openai = OpenAI(api_key=SETTINGS["openai_api_key"])

---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\data\explorer\utils.py
Line: 121
Match: api_key
ContextBefore:
        openai_api_key = getpass.getpass("OpenAI API key: ")
        SETTINGS.update({"openai_api_key": openai_api_key})
MatchedLine:
    openai = OpenAI(api_key=SETTINGS["openai_api_key"])
ContextAfter:

    messages = [
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\data\explorer\gui\dash.py
Line: 146
Match: api_key
ContextBefore:
def run_ai_query():
    """Execute SQL query and update session state with query results."""
MatchedLine:
    if not SETTINGS["openai_api_key"]:
ContextAfter:
        st.session_state["error"] = (
            'OpenAI API key not found in settings. Please run yolo settings openai_api_key="..."'
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\data\explorer\gui\dash.py
Line: 148
Match: api_key
ContextBefore:
    if not SETTINGS["openai_api_key"]:
        st.session_state["error"] = (
MatchedLine:
            'OpenAI API key not found in settings. Please run yolo settings openai_api_key="..."'
ContextAfter:
        )
        return
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\engine\model.py
Line: 190
Match: APIKEY
ContextBefore:
            (
                model.startswith(f"{HUB_WEB_ROOT}/models/"),  # i.e. https://hub.ultralytics.com/models/MODEL_ID
MatchedLine:
                [len(x) for x in model.split("_")] == [42, 20],  # APIKEY_MODEL
ContextAfter:
                len(model) == 20 and not Path(model).exists() and all(x not in model for x in "./\\"),  # MODEL
            )
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 8
Match: API_KEY
ContextBefore:
from ultralytics.utils import LOGGER, SETTINGS, emojis, is_colab

MatchedLine:
API_KEY_URL = f"{HUB_WEB_ROOT}/settings?tab=api+keys"
ContextAfter:


---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 21
Match: token
ContextBefore:

    Attributes:
MatchedLine:
        id_token (str or bool): Token used for identity verification, initialized as False.
ContextAfter:
        api_key (str or bool): API key for authentication, initialized as False.
        model_key (bool): Placeholder for model key, initialized as False.
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 22
Match: api_key
ContextBefore:
    Attributes:
        id_token (str or bool): Token used for identity verification, initialized as False.
MatchedLine:
        api_key (str or bool): API key for authentication, initialized as False.
ContextAfter:
        model_key (bool): Placeholder for model key, initialized as False.
    """
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 26
Match: token
ContextBefore:
    """

MatchedLine:
    id_token = api_key = model_key = False
ContextAfter:

    def __init__(self, api_key="", verbose=False):
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 28
Match: api_key
ContextBefore:
    id_token = api_key = model_key = False

MatchedLine:
    def __init__(self, api_key="", verbose=False):
ContextAfter:
        """
        Initialize the Auth class with an optional API key.
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 33
Match: api_key
ContextBefore:

        Args:
MatchedLine:
            api_key (str, optional): May be an API key or a combination API key and model ID, i.e. key_id
ContextAfter:
        """
        # Split the input API key in case it contains a combined key_model and keep only the API key part
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 36
Match: api_key
ContextBefore:
        """
        # Split the input API key in case it contains a combined key_model and keep only the API key part
MatchedLine:
        api_key = api_key.split("_")[0]
ContextAfter:

        # Set API key attribute as value passed or SETTINGS API key if none passed
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 39
Match: api_key
ContextBefore:

        # Set API key attribute as value passed or SETTINGS API key if none passed
MatchedLine:
        self.api_key = api_key or SETTINGS.get("api_key", "")
ContextAfter:

        # If an API key is provided
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 42
Match: api_key
ContextBefore:

        # If an API key is provided
MatchedLine:
        if self.api_key:
ContextAfter:
            # If the provided API key matches the API key in the SETTINGS
            if self.api_key == SETTINGS.get("api_key"):
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 44
Match: api_key
ContextBefore:
        if self.api_key:
            # If the provided API key matches the API key in the SETTINGS
MatchedLine:
            if self.api_key == SETTINGS.get("api_key"):
ContextAfter:
                # Log that the user is already logged in
                if verbose:
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 58
Match: api_key
ContextBefore:
        else:
            # Request an API key
MatchedLine:
            success = self.request_api_key()
ContextAfter:

        # Update SETTINGS with the new API key after successful authentication
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 62
Match: api_key
ContextBefore:
        # Update SETTINGS with the new API key after successful authentication
        if success:
MatchedLine:
            SETTINGS.update({"api_key": self.api_key})
ContextAfter:
            # Log that the new login was successful
            if verbose:
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 67
Match: API_KEY
ContextBefore:
                LOGGER.info(f"{PREFIX}New authentication successful ✅")
        elif verbose:
MatchedLine:
            LOGGER.info(f"{PREFIX}Get API key from {API_KEY_URL} and then run 'yolo hub login API_KEY'")
ContextAfter:

    def request_api_key(self, max_attempts=3):
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 69
Match: api_key
ContextBefore:
            LOGGER.info(f"{PREFIX}Get API key from {API_KEY_URL} and then run 'yolo hub login API_KEY'")

MatchedLine:
    def request_api_key(self, max_attempts=3):
ContextAfter:
        """
        Prompt the user to input their API key.
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 79
Match: API_KEY
ContextBefore:
        for attempts in range(max_attempts):
            LOGGER.info(f"{PREFIX}Login. Attempt {attempts + 1} of {max_attempts}")
MatchedLine:
            input_key = getpass.getpass(f"Enter API key from {API_KEY_URL} ")
ContextAfter:
            self.api_key = input_key.split("_")[0]  # remove model id if present
            if self.authenticate():
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 80
Match: api_key
ContextBefore:
            LOGGER.info(f"{PREFIX}Login. Attempt {attempts + 1} of {max_attempts}")
            input_key = getpass.getpass(f"Enter API key from {API_KEY_URL} ")
MatchedLine:
            self.api_key = input_key.split("_")[0]  # remove model id if present
ContextAfter:
            if self.authenticate():
                return True
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 87
Match: token
ContextBefore:
    def authenticate(self) -> bool:
        """
MatchedLine:
        Attempt to authenticate with the server using either id_token or API key.
ContextAfter:

        Returns:
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 100
Match: token
ContextBefore:
            raise ConnectionError("User has not authenticated locally.")
        except ConnectionError:
MatchedLine:
            self.id_token = self.api_key = False  # reset invalid
ContextAfter:
            LOGGER.warning(f"{PREFIX}Invalid API key ⚠️")
            return False
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 106
Match: token
ContextBefore:
    def auth_with_cookies(self) -> bool:
        """
MatchedLine:
        Attempt to fetch authentication via cookies and set id_token. User must be logged in to HUB and running in a
ContextAfter:
        supported browser.

---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 117
Match: token
ContextBefore:
            authn = request_with_credentials(f"{HUB_API_ROOT}/v1/auth/auto")
            if authn.get("success", False):
MatchedLine:
                self.id_token = authn.get("data", {}).get("idToken", None)
ContextAfter:
                self.authenticate()
                return True
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 122
Match: token
ContextBefore:
            raise ConnectionError("Unable to fetch browser authentication details.")
        except ConnectionError:
MatchedLine:
            self.id_token = False  # reset invalid
ContextAfter:
            return False

---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 130
Match: token
ContextBefore:

        Returns:
MatchedLine:
            (dict): The authentication header if id_token or API key is set, None otherwise.
ContextAfter:
        """
        if self.id_token:
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 132
Match: token
ContextBefore:
            (dict): The authentication header if id_token or API key is set, None otherwise.
        """
MatchedLine:
        if self.id_token:
ContextAfter:
            return {"authorization": f"Bearer {self.id_token}"}
        elif self.api_key:
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 133
Match: token
ContextBefore:
        """
        if self.id_token:
MatchedLine:
            return {"authorization": f"Bearer {self.id_token}"}
ContextAfter:
        elif self.api_key:
            return {"x-api-key": self.api_key}
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 134
Match: api_key
ContextBefore:
        if self.id_token:
            return {"authorization": f"Bearer {self.id_token}"}
MatchedLine:
        elif self.api_key:
ContextAfter:
            return {"x-api-key": self.api_key}
        # else returns None
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\auth.py
Line: 135
Match: api-key
ContextBefore:
            return {"authorization": f"Bearer {self.id_token}"}
        elif self.api_key:
MatchedLine:
            return {"x-api-key": self.api_key}
ContextAfter:
        # else returns None
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\session.py
Line: 59
Match: api_key
ContextBefore:

        # Parse input
MatchedLine:
        api_key, model_id, self.filename = self._parse_identifier(identifier)
ContextAfter:

        # Get credentials
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\session.py
Line: 62
Match: api_key
ContextBefore:

        # Get credentials
MatchedLine:
        active_key = api_key or SETTINGS.get("api_key")
ContextAfter:
        credentials = {"api_key": active_key} if active_key else None  # set credentials

---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\session.py
Line: 63
Match: api_key
ContextBefore:
        # Get credentials
        active_key = api_key or SETTINGS.get("api_key")
MatchedLine:
        credentials = {"api_key": active_key} if active_key else None  # set credentials
ContextAfter:

        # Initialize client
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\session.py
Line: 146
Match: api_key
ContextBefore:

        # Initialize variables
MatchedLine:
        api_key, model_id, filename = None, None, None
ContextAfter:

        # Check if identifier is a HUB URL
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\session.py
Line: 158
Match: api_key
ContextBefore:
            # Check if identifier is in the format of API key and model ID
            if len(parts) == 2 and len(parts[0]) == 42 and len(parts[1]) == 20:
MatchedLine:
                api_key, model_id = parts
ContextAfter:
            # Check if identifier is a single model ID
            elif len(parts) == 1 and len(parts[0]) == 20:
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\session.py
Line: 168
Match: apiKey
ContextBefore:
                raise HUBModelError(
                    f"model='{identifier}' could not be parsed. Check format is correct. "
MatchedLine:
                    f"Supported formats are Ultralytics HUB URL, apiKey_modelId, modelId, local pt or yaml file."
ContextAfter:
                )

---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\session.py
Line: 171
Match: api_key
ContextBefore:
                )

MatchedLine:
        return api_key, model_id, filename
ContextAfter:

    def _set_train_args(self):
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\utils.py
Line: 183
Match: secret
ContextBefore:
    """

MatchedLine:
    url = "https://www.google-analytics.com/mp/collect?measurement_id=G-X8NCJYTQXM&api_secret=<REDACTED>"
ContextAfter:

    def __init__(self):
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\__init__.py
Line: 11
Match: api_key
ContextBefore:


MatchedLine:
def login(api_key: str = None, save=True) -> bool:
ContextAfter:
    """
    Log in to the Ultralytics HUB API using the provided API key.
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\__init__.py
Line: 15
Match: API_KEY
ContextBefore:
    Log in to the Ultralytics HUB API using the provided API key.

MatchedLine:
    The session is not stored; a new session is created when needed using the saved SETTINGS or the HUB_API_KEY
ContextAfter:
    environment variable if successfully authenticated.

---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\__init__.py
Line: 19
Match: api_key
ContextBefore:

    Args:
MatchedLine:
        api_key (str, optional): API key to use for authentication.
ContextAfter:
            If not provided, it will be retrieved from SETTINGS or HUB_API_KEY environment variable.
        save (bool, optional): Whether to save the API key to SETTINGS if authentication is successful.
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\__init__.py
Line: 20
Match: API_KEY
ContextBefore:
    Args:
        api_key (str, optional): API key to use for authentication.
MatchedLine:
            If not provided, it will be retrieved from SETTINGS or HUB_API_KEY environment variable.
ContextAfter:
        save (bool, optional): Whether to save the API key to SETTINGS if authentication is successful.

---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\__init__.py
Line: 29
Match: api_key
ContextBefore:
    from hub_sdk import HUBClient

MatchedLine:
    api_key_url = f"{HUB_WEB_ROOT}/settings?tab=api+keys"  # set the redirect URL
ContextAfter:
    saved_key = SETTINGS.get("api_key")
    active_key = api_key or saved_key
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\__init__.py
Line: 30
Match: api_key
ContextBefore:

    api_key_url = f"{HUB_WEB_ROOT}/settings?tab=api+keys"  # set the redirect URL
MatchedLine:
    saved_key = SETTINGS.get("api_key")
ContextAfter:
    active_key = api_key or saved_key
    credentials = {"api_key": active_key} if active_key and active_key != "" else None  # set credentials
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\__init__.py
Line: 31
Match: api_key
ContextBefore:
    api_key_url = f"{HUB_WEB_ROOT}/settings?tab=api+keys"  # set the redirect URL
    saved_key = SETTINGS.get("api_key")
MatchedLine:
    active_key = api_key or saved_key
ContextAfter:
    credentials = {"api_key": active_key} if active_key and active_key != "" else None  # set credentials

---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\__init__.py
Line: 32
Match: api_key
ContextBefore:
    saved_key = SETTINGS.get("api_key")
    active_key = api_key or saved_key
MatchedLine:
    credentials = {"api_key": active_key} if active_key and active_key != "" else None  # set credentials
ContextAfter:

    client = HUBClient(credentials)  # initialize HUBClient
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\__init__.py
Line: 39
Match: api_key
ContextBefore:
        # Successfully authenticated with HUB

MatchedLine:
        if save and client.api_key != saved_key:
ContextAfter:
            SETTINGS.update({"api_key": client.api_key})  # update settings with valid API key

---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\__init__.py
Line: 40
Match: api_key
ContextBefore:

        if save and client.api_key != saved_key:
MatchedLine:
            SETTINGS.update({"api_key": client.api_key})  # update settings with valid API key
ContextAfter:

        # Set message based on whether key was provided or retrieved from settings
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\__init__.py
Line: 44
Match: api_key
ContextBefore:
        # Set message based on whether key was provided or retrieved from settings
        log_message = (
MatchedLine:
            "New authentication successful ✅" if client.api_key == api_key or not credentials else "Authenticated ✅"
ContextAfter:
        )
        LOGGER.info(f"{PREFIX}{log_message}")
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\__init__.py
Line: 51
Match: api_key
ContextBefore:
    else:
        # Failed to authenticate with HUB
MatchedLine:
        LOGGER.info(f"{PREFIX}Get API key from {api_key_url} and then run 'yolo hub login API_KEY'")
ContextAfter:
        return False

---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\__init__.py
Line: 66
Match: api_key
ContextBefore:
        ```
    """
MatchedLine:
    SETTINGS["api_key"] = ""
ContextAfter:
    SETTINGS.save()
    LOGGER.info(f"{PREFIX}logged out ✅. To log in again, use 'yolo hub login'.")
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\__init__.py
Line: 73
Match: api-key
ContextBefore:
def reset_model(model_id=""):
    """Reset a trained model to an untrained state."""
MatchedLine:
    r = requests.post(f"{HUB_API_ROOT}/model-reset", json={"modelId": model_id}, headers={"x-api-key": Auth().api_key})
ContextAfter:
    if r.status_code == 200:
        LOGGER.info(f"{PREFIX}Model reset successfully")
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\__init__.py
Line: 91
Match: api-key
ContextBefore:
    assert format in export_fmts_hub(), f"Unsupported export format '{format}', valid formats are {export_fmts_hub()}"
    r = requests.post(
MatchedLine:
        f"{HUB_API_ROOT}/v1/models/{model_id}/export", json={"format": format}, headers={"x-api-key": Auth().api_key}
ContextAfter:
    )
    assert r.status_code == 200, f"{PREFIX}{format} export failure {r.status_code} {r.reason}"
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\__init__.py
Line: 102
Match: apiKey
ContextBefore:
    r = requests.post(
        f"{HUB_API_ROOT}/get-export",
MatchedLine:
        json={"apiKey": Auth().api_key, "modelId": model_id, "format": format},
ContextAfter:
        headers={"x-api-key": Auth().api_key},
    )
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\hub\__init__.py
Line: 103
Match: api-key
ContextBefore:
        f"{HUB_API_ROOT}/get-export",
        json={"apiKey": Auth().api_key, "modelId": model_id, "format": format},
MatchedLine:
        headers={"x-api-key": Auth().api_key},
ContextAfter:
    )
    assert r.status_code == 200, f"{PREFIX}{format} get_export failure {r.status_code} {r.reason}"
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\fastsam\prompt.py
Line: 251
Match: token
ContextBefore:
        """Processes images and text with a model, calculates similarity, and returns softmax score."""
        preprocessed_images = [preprocess(image).to(device) for image in elements]
MatchedLine:
        tokenized_text = self.clip.tokenize([search_text]).to(device)
ContextAfter:
        stacked_images = torch.stack(preprocessed_images)
        image_features = model.encode_image(stacked_images)
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\fastsam\prompt.py
Line: 254
Match: token
ContextBefore:
        stacked_images = torch.stack(preprocessed_images)
        image_features = model.encode_image(stacked_images)
MatchedLine:
        text_features = model.encode_text(tokenized_text)
ContextAfter:
        image_features /= image_features.norm(dim=-1, keepdim=True)
        text_features /= text_features.norm(dim=-1, keepdim=True)
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 21
Match: token
ContextBefore:
        transformer (nn.Module): The transformer module used for mask prediction.
        num_multimask_outputs (int): Number of masks to predict for disambiguating masks.
MatchedLine:
        iou_token (nn.Embedding): Embedding for the IoU token.
ContextAfter:
        num_mask_tokens (int): Number of mask tokens.
        mask_tokens (nn.Embedding): Embedding for the mask tokens.
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 22
Match: token
ContextBefore:
        num_multimask_outputs (int): Number of masks to predict for disambiguating masks.
        iou_token (nn.Embedding): Embedding for the IoU token.
MatchedLine:
        num_mask_tokens (int): Number of mask tokens.
ContextAfter:
        mask_tokens (nn.Embedding): Embedding for the mask tokens.
        output_upscaling (nn.Sequential): Neural network sequence for upscaling the output.
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 23
Match: token
ContextBefore:
        iou_token (nn.Embedding): Embedding for the IoU token.
        num_mask_tokens (int): Number of mask tokens.
MatchedLine:
        mask_tokens (nn.Embedding): Embedding for the mask tokens.
ContextAfter:
        output_upscaling (nn.Sequential): Neural network sequence for upscaling the output.
        output_hypernetworks_mlps (nn.ModuleList): Hypernetwork MLPs for generating masks.
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 56
Match: token
ContextBefore:
        self.num_multimask_outputs = num_multimask_outputs

MatchedLine:
        self.iou_token = nn.Embedding(1, transformer_dim)
ContextAfter:
        self.num_mask_tokens = num_multimask_outputs + 1
        self.mask_tokens = nn.Embedding(self.num_mask_tokens, transformer_dim)
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 57
Match: token
ContextBefore:

        self.iou_token = nn.Embedding(1, transformer_dim)
MatchedLine:
        self.num_mask_tokens = num_multimask_outputs + 1
ContextAfter:
        self.mask_tokens = nn.Embedding(self.num_mask_tokens, transformer_dim)

---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 58
Match: token
ContextBefore:
        self.iou_token = nn.Embedding(1, transformer_dim)
        self.num_mask_tokens = num_multimask_outputs + 1
MatchedLine:
        self.mask_tokens = nn.Embedding(self.num_mask_tokens, transformer_dim)
ContextAfter:

        self.output_upscaling = nn.Sequential(
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 68
Match: token
ContextBefore:
        )
        self.output_hypernetworks_mlps = nn.ModuleList(
MatchedLine:
            [MLP(transformer_dim, transformer_dim, transformer_dim // 8, 3) for _ in range(self.num_mask_tokens)]
ContextAfter:
        )

---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 71
Match: token
ContextBefore:
        )

MatchedLine:
        self.iou_prediction_head = MLP(transformer_dim, iou_head_hidden_dim, self.num_mask_tokens, iou_head_depth)
ContextAfter:

    def forward(
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 122
Match: token
ContextBefore:
        See 'forward' for more details.
        """
MatchedLine:
        # Concatenate output tokens
ContextAfter:
        output_tokens = torch.cat([self.iou_token.weight, self.mask_tokens.weight], dim=0)
        output_tokens = output_tokens.unsqueeze(0).expand(sparse_prompt_embeddings.shape[0], -1, -1)
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 123
Match: token
ContextBefore:
        """
        # Concatenate output tokens
MatchedLine:
        output_tokens = torch.cat([self.iou_token.weight, self.mask_tokens.weight], dim=0)
ContextAfter:
        output_tokens = output_tokens.unsqueeze(0).expand(sparse_prompt_embeddings.shape[0], -1, -1)
        tokens = torch.cat((output_tokens, sparse_prompt_embeddings), dim=1)
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 124
Match: token
ContextBefore:
        # Concatenate output tokens
        output_tokens = torch.cat([self.iou_token.weight, self.mask_tokens.weight], dim=0)
MatchedLine:
        output_tokens = output_tokens.unsqueeze(0).expand(sparse_prompt_embeddings.shape[0], -1, -1)
ContextAfter:
        tokens = torch.cat((output_tokens, sparse_prompt_embeddings), dim=1)

---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 125
Match: token
ContextBefore:
        output_tokens = torch.cat([self.iou_token.weight, self.mask_tokens.weight], dim=0)
        output_tokens = output_tokens.unsqueeze(0).expand(sparse_prompt_embeddings.shape[0], -1, -1)
MatchedLine:
        tokens = torch.cat((output_tokens, sparse_prompt_embeddings), dim=1)
ContextAfter:

        # Expand per-image data in batch direction to be per-mask
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 128
Match: token
ContextBefore:

        # Expand per-image data in batch direction to be per-mask
MatchedLine:
        src = torch.repeat_interleave(image_embeddings, tokens.shape[0], dim=0)
ContextAfter:
        src = src + dense_prompt_embeddings
        pos_src = torch.repeat_interleave(image_pe, tokens.shape[0], dim=0)
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 130
Match: token
ContextBefore:
        src = torch.repeat_interleave(image_embeddings, tokens.shape[0], dim=0)
        src = src + dense_prompt_embeddings
MatchedLine:
        pos_src = torch.repeat_interleave(image_pe, tokens.shape[0], dim=0)
ContextAfter:
        b, c, h, w = src.shape

---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 134
Match: token
ContextBefore:

        # Run the transformer
MatchedLine:
        hs, src = self.transformer(src, pos_src, tokens)
ContextAfter:
        iou_token_out = hs[:, 0, :]
        mask_tokens_out = hs[:, 1 : (1 + self.num_mask_tokens), :]
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 135
Match: token
ContextBefore:
        # Run the transformer
        hs, src = self.transformer(src, pos_src, tokens)
MatchedLine:
        iou_token_out = hs[:, 0, :]
ContextAfter:
        mask_tokens_out = hs[:, 1 : (1 + self.num_mask_tokens), :]

---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 136
Match: token
ContextBefore:
        hs, src = self.transformer(src, pos_src, tokens)
        iou_token_out = hs[:, 0, :]
MatchedLine:
        mask_tokens_out = hs[:, 1 : (1 + self.num_mask_tokens), :]
ContextAfter:

        # Upscale mask embeddings and predict masks using the mask tokens
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 138
Match: token
ContextBefore:
        mask_tokens_out = hs[:, 1 : (1 + self.num_mask_tokens), :]

MatchedLine:
        # Upscale mask embeddings and predict masks using the mask tokens
ContextAfter:
        src = src.transpose(1, 2).view(b, c, h, w)
        upscaled_embedding = self.output_upscaling(src)
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 142
Match: token
ContextBefore:
        upscaled_embedding = self.output_upscaling(src)
        hyper_in_list: List[torch.Tensor] = [
MatchedLine:
            self.output_hypernetworks_mlps[i](mask_tokens_out[:, i, :]) for i in range(self.num_mask_tokens)
ContextAfter:
        ]
        hyper_in = torch.stack(hyper_in_list, dim=1)
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\decoders.py
Line: 149
Match: token
ContextBefore:

        # Generate mask quality predictions
MatchedLine:
        iou_pred = self.iou_prediction_head(iou_token_out)
ContextAfter:

        return masks, iou_pred
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\encoders.py
Line: 457
Match: token
ContextBefore:
    Partition into non-overlapping windows with padding if needed.
    Args:
MatchedLine:
        x (tensor): input tokens with [B, H, W, C].
ContextAfter:
        window_size (int): window size.

---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\encoders.py
Line: 484
Match: token
ContextBefore:

    Args:
MatchedLine:
        windows (tensor): input tokens with [B * num_windows, window_size, window_size, C].
ContextAfter:
        window_size (int): window size.
        pad_hw (Tuple): padded height and width (Hp, Wp).
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\transformer.py
Line: 25
Match: token
ContextBefore:
        mlp_dim (int): The internal channel dimension for the MLP block.
        layers (nn.ModuleList): The list of TwoWayAttentionBlock layers that make up the transformer.
MatchedLine:
        final_attn_token_to_image (Attention): The final attention layer applied from the queries to the image.
ContextAfter:
        norm_final_attn (nn.LayerNorm): The layer normalization applied to the final queries.
    """
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\transformer.py
Line: 68
Match: token
ContextBefore:
            )

MatchedLine:
        self.final_attn_token_to_image = Attention(embedding_dim, num_heads, downsample_rate=attention_downsample_rate)
ContextAfter:
        self.norm_final_attn = nn.LayerNorm(embedding_dim)

---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\transformer.py
Line: 88
Match: token
ContextBefore:
          (torch.Tensor): the processed image_embedding
        """
MatchedLine:
        # BxCxHxW -> BxHWxC == B x N_image_tokens x C
ContextAfter:
        bs, c, h, w = image_embedding.shape
        image_embedding = image_embedding.flatten(2).permute(0, 2, 1)
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\transformer.py
Line: 109
Match: token
ContextBefore:
        q = queries + point_embedding
        k = keys + image_pe
MatchedLine:
        attn_out = self.final_attn_token_to_image(q=q, k=k, v=keys)
ContextAfter:
        queries = queries + attn_out
        queries = self.norm_final_attn(queries)
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\transformer.py
Line: 126
Match: token
ContextBefore:
        self_attn (Attention): The self-attention layer for the queries.
        norm1 (nn.LayerNorm): Layer normalization following the first attention block.
MatchedLine:
        cross_attn_token_to_image (Attention): Cross-attention layer from queries to keys.
ContextAfter:
        norm2 (nn.LayerNorm): Layer normalization following the second attention block.
        mlp (MLPBlock): MLP block that transforms the query embeddings.
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\transformer.py
Line: 131
Match: token
ContextBefore:
        norm3 (nn.LayerNorm): Layer normalization following the MLP block.
        norm4 (nn.LayerNorm): Layer normalization following the third attention block.
MatchedLine:
        cross_attn_image_to_token (Attention): Cross-attention layer from keys to queries.
ContextAfter:
        skip_first_layer_pe (bool): Whether to skip the positional encoding in the first layer.
    """
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\transformer.py
Line: 160
Match: token
ContextBefore:
        self.norm1 = nn.LayerNorm(embedding_dim)

MatchedLine:
        self.cross_attn_token_to_image = Attention(embedding_dim, num_heads, downsample_rate=attention_downsample_rate)
ContextAfter:
        self.norm2 = nn.LayerNorm(embedding_dim)

---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\transformer.py
Line: 167
Match: token
ContextBefore:

        self.norm4 = nn.LayerNorm(embedding_dim)
MatchedLine:
        self.cross_attn_image_to_token = Attention(embedding_dim, num_heads, downsample_rate=attention_downsample_rate)
ContextAfter:

        self.skip_first_layer_pe = skip_first_layer_pe
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\transformer.py
Line: 183
Match: token
ContextBefore:
        queries = self.norm1(queries)

MatchedLine:
        # Cross attention block, tokens attending to image embedding
ContextAfter:
        q = queries + query_pe
        k = keys + key_pe
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\transformer.py
Line: 186
Match: token
ContextBefore:
        q = queries + query_pe
        k = keys + key_pe
MatchedLine:
        attn_out = self.cross_attn_token_to_image(q=q, k=k, v=keys)
ContextAfter:
        queries = queries + attn_out
        queries = self.norm2(queries)
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\transformer.py
Line: 195
Match: token
ContextBefore:
        queries = self.norm3(queries)

MatchedLine:
        # Cross attention block, image embedding attending to tokens
ContextAfter:
        q = queries + query_pe
        k = keys + key_pe
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\transformer.py
Line: 198
Match: token
ContextBefore:
        q = queries + query_pe
        k = keys + key_pe
MatchedLine:
        attn_out = self.cross_attn_image_to_token(q=k, k=q, v=queries)
ContextAfter:
        keys = keys + attn_out
        keys = self.norm4(keys)
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\transformer.py
Line: 243
Match: token
ContextBefore:
        b, n, c = x.shape
        x = x.reshape(b, n, num_heads, c // num_heads)
MatchedLine:
        return x.transpose(1, 2)  # B x N_heads x N_tokens x C_per_head
ContextAfter:

    @staticmethod
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\transformer.py
Line: 248
Match: token
ContextBefore:
    def _recombine_heads(x: Tensor) -> Tensor:
        """Recombine the separated attention heads into a single tensor."""
MatchedLine:
        b, n_heads, n_tokens, c_per_head = x.shape
ContextAfter:
        x = x.transpose(1, 2)
        return x.reshape(b, n_tokens, n_heads * c_per_head)  # B x N_tokens x C
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\transformer.py
Line: 250
Match: token
ContextBefore:
        b, n_heads, n_tokens, c_per_head = x.shape
        x = x.transpose(1, 2)
MatchedLine:
        return x.reshape(b, n_tokens, n_heads * c_per_head)  # B x N_tokens x C
ContextAfter:

    def forward(self, q: Tensor, k: Tensor, v: Tensor) -> Tensor:
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\models\sam\modules\transformer.py
Line: 267
Match: token
ContextBefore:
        # Attention
        _, _, _, c_per_head = q.shape
MatchedLine:
        attn = q @ k.permute(0, 1, 3, 2)  # B x N_heads x N_tokens x N_tokens
ContextAfter:
        attn = attn / math.sqrt(c_per_head)
        attn = torch.softmax(attn, dim=-1)
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\nn\tasks.py
Line: 592
Match: token
ContextBefore:
            self.clip_model = clip.load("ViT-B/32")[0]
        device = next(self.clip_model.parameters()).device
MatchedLine:
        text_token = clip.tokenize(text).to(device)
ContextAfter:
        txt_feats = self.clip_model.encode_text(text_token).to(dtype=torch.float32)
        txt_feats = txt_feats / txt_feats.norm(p=2, dim=-1, keepdim=True)
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\nn\tasks.py
Line: 593
Match: token
ContextBefore:
        device = next(self.clip_model.parameters()).device
        text_token = clip.tokenize(text).to(device)
MatchedLine:
        txt_feats = self.clip_model.encode_text(text_token).to(dtype=torch.float32)
ContextAfter:
        txt_feats = txt_feats / txt_feats.norm(p=2, dim=-1, keepdim=True)
        self.txt_feats = txt_feats.reshape(-1, len(text), txt_feats.shape[-1]).detach()
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\utils\downloads.py
Line: 267
Match: token
ContextBefore:
        for k, v in response.cookies.items():
            if k.startswith("download_warning"):
MatchedLine:
                drive_url += f"&confirm={v}"  # v is token
ContextAfter:
        cd = response.headers.get("content-disposition")
        if cd:
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\utils\__init__.py
Line: 938
Match: api_key
ContextBefore:
            "uuid": hashlib.sha256(str(uuid.getnode()).encode()).hexdigest(),
            "sync": True,
MatchedLine:
            "api_key": "",
ContextAfter:
            "openai_api_key": "",
            "clearml": True,  # integrations
---
Path: D:\pythonproject\YHJ\multi-classification\ultralytics\utils\__init__.py
Line: 939
Match: api_key
ContextBefore:
            "sync": True,
            "api_key": "",
MatchedLine:
            "openai_api_key": "",
ContextAfter:
            "clearml": True,  # integrations
            "comet": True,
